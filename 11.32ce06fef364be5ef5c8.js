(self.webpackChunkngx_al_libs=self.webpackChunkngx_al_libs||[]).push([[11],{27011:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NgxAlFormReportDesignerModule:()=>h});var i=r(37716),o=r(38583),s=r(31077),a=r(9462),n=r(11343),l=r(19261),p=r(3679);const d=[{path:"",component:(()=>{class e{constructor(e,t,r,i,o){this.reportService=e,this.location=t,this.route=r,this.rptApiSvc=i,this.storage=o,this.formSchema={},this.layoutItem={},this.formName="",this.systemName="",this.reportLayoutComponents=a.BAC.reportLayoutComponents,this.reportPropertiesComponents=a.BAC.reportPropsComponents,a.aqO.subscribe(e=>{this.rParams=e}),this.reportService.ReportSchema$.subscribe(e=>{if(this.designer){this.designer.report.reportFile=this.reportService.ReportSchema$.value.systemName,this.designer.report.load(e.jsonSchema),this.designer.renderHtml("designer"),this.designer.viewer.jsObject.options.appearance.minParametersCountForMultiColumns=1;var t=new n.Stimulsoft.Report.Dictionary.StiVariable("","User","User",typeof String),r=new n.Stimulsoft.Report.Dictionary.StiVariable("","recordEntityId","recordEntityId",typeof String),i=new n.Stimulsoft.Report.Dictionary.StiVariable("","IpAddress","IpAddress",typeof String),o=new n.Stimulsoft.Report.Dictionary.StiVariable("","url","url",typeof String),s=new n.Stimulsoft.Report.Dictionary.StiVariable("","formReportId","formReportId",typeof String);this.designer.report.dictionary.variables.add(t),this.designer.report.dictionary.variables.add(r),this.designer.report.dictionary.variables.add(i),this.designer.report.dictionary.variables.add(o),this.designer.report.dictionary.variables.add(s),this.reportService.formSchema=this.formSchema}}),this.reportService.getLayout(),this.reportService.validationPopUp$.subscribe(e=>this.validateDetails(e))}ngOnInit(){console.log("Loading Designer view"),console.log("Set full screen mode for the designer"),this.options=new n.Stimulsoft.Designer.StiDesignerOptions,this.options.appearance.fullScreenMode=!1,this.options.toolbar.showFileMenu=!0,this.options.toolbar.showNewDashboardButton=!0,this.options.toolbar.showSendEmailButton=!0,this.options.viewerOptions.appearance.parametersPanelColumnsCount=4,n.StiOptions.Export.Pdf.divideSegmentPages=!1,this.options.appearance.parametersPanelDateFormat="dd/MM/yyyy",this.options.appearance.showTooltipsHelp=!1,this.options.appearance.showDialogsHelp=!1,n.StiOptions.WebServer.url=(0,a.CBd)()+"api/reportquery/DataAdapter",n.Stimulsoft.Base.StiLicense.key="6vJhGtLLLz2GNviWmUTrhSqnOItdDwjBylQzQcAOiHkgWK3zcs2OkVE3pbdmr5az7YhDM6Dwd5Aidm7rEniWrrV0ay8lSwXQeVuTewKTSdpLIq+39NzdAx3jIm6zeeNRg2WnSeefguayBttBXF3hXlPcRiBEEtm03YqoFpGdTIEgPfMKXunvsBo0a+116WQwj8MFOpaHmeyxX4gOdLucfPANpbeyBGVWX3JpafvJr6K2PwBuaBUGeJF5bXprJlBcebZD3fgXYBE4Y553R3gzjmo2NUY2R4C4ers1Tg6hwKbZZaBnj0Hmmtbi7gn/UfGp3KQlPQdV1p7lWA8qaTZk7W6xH6NFMYh7JwKtYiKDCyARGjAsEEfALg1uh/MKS8ZIf1pmDGsJlvk9wndqLq4ZWseMDUuhjK1ZmKVFNjBcLEi/zqbklxQK3GnHiq6+8xJ/Brr255Z7pFSEnmgTkN8rcat+znkZn0y/0m3yuDHSrNZhaNCDym4x2kCIG+HDzK45YDFCYginr9b880JtPBzxuyOM2F3MpHw5mY8/2YxQRh1F1YTWyePVZXB8/W6GURNhpr8/v/8fiXoka8/oPiPBUQ==",this.options.viewerOptions.toolbar.viewMode=1,console.log("Create the report designer with specified options"),this.designer=new n.Stimulsoft.Designer.StiDesigner(this.options,"StiDesigner",!1),this.designer.onSaveReport=e=>{let t=e.report.saveToJsonString(),r=e.report.reportFile,i=e.fileName;this.reportService.ReportSchema$.value.name=i.split(".mrt")[0],this.reportService.ReportSchema$.value.systemName=r||i,this.reportService.ReportSchema$.value.jsonSchema=t,this.saveForm()},console.log("Edit report template in the designer"),this.designer.report=new n.Stimulsoft.Report.StiReport,console.log("Rendering the designer to selected element"),this.designer.renderHtml("designer")}saveReport(e,t,r){this.rParams.has(a.k7h),this.rptApiSvc.post("report",{name:t,systemName:r,jsonSchema:e},(0,a.mag)(this.rParams)).subscribe(e=>{alert("Form Saved"),this.location.back()},e=>{console.log(e)})}back(){this.location.back()}saveForm(){if(""==this.reportService.ReportSchema$.value.name||""==this.reportService.ReportSchema$.value.systemName)return $("#formDetailsModal").modal({backdrop:"static",keyboard:!1}),!1;this.reportService.saveReport()}isSaveDisabled(){return this.layoutItem.children.length<1}validateDetails(e){if(null!=e){var t=Object.entries(e),r=[],i="";$("#formvalidationerrors").length>0&&$("#formvalidationerrors").remove();for(var o=new Object,s=0;s<t.length;s++){var a=JSON.parse(t[s][1]);if(a.name)this.createValidationControls(o,a);else{var n=Object.entries(a);for(let e=0;e<n.length;e++)this.createValidationControls(o,a=n[e][1])}}r=[];for(let e in o)if(i="",o.hasOwnProperty(e)&&void 0!==o[e]&&null!=o[e]){var l=e+" : ";r.push('<div class="ErrorMsgList">'),r.push("<h6>"+l+"</h6>");for(let t in o[e])o[e].hasOwnProperty(t)&&r.push(i="<ul><li><b>"+o[e][t].property+"</b> - <span>"+o[e][t].errorMessage+"</span></li></ul>");r.push("</div>")}i=r.join(""),$("#formvalidationerrors").length>0&&$("#formvalidationerrors").remove();var p='<div class="modal fade" data-backdrop="static" data-keyboard="false" id="formvalidationerrors" role="dialog"> <div class="modal-dialog modal-dialog-scrollable"> <div class="modal-content"> <div class="modal-header" style="background:#ff4c52"> <div class="d-flex align-items-center"><i class="fas fa-exclamation-triangle text-white text-lg mr-2"></i> <h5 class="modal-title text-white">Alert</h5> </div> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"> '+i+" </div></div></div></div>";$("body").append(p),$("#formvalidationerrors").modal("show")}}createValidationControls(e,t){if(e[t.name]){var r=e[t.name];r.push(t),e[t.name]=r}else{var i=new Array;i.push(t),e[t.name]=i}}clearCanvas(){return 1==confirm("Do you want to clear?")&&(this.reportService.clearReportSchema(),!0)}onWindowClose(e){this.storage.SetParamState(a.aqO.value)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(a.zhA),i.Y36(o.Ye),i.Y36(s.gz),i.Y36(a._sm),i.Y36(a.eJM))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-report-designer"]],hostBindings:function(e,t){1&e&&i.NdJ("beforeunload",function(e){return t.onWindowClose(e)},!1,i.Jf7)},features:[i._Bn([a.zhA])],decls:1,vars:0,consts:[["id","designer"]],template:function(e,t){1&e&&i._UZ(0,"div",0)},styles:[""]}),e})(),canActivate:[a.N9q]}];let c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[s.Bz.forChild(d)],s.Bz]}),e})(),h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[o.ez,c,l.UH,p.u5,p.UX,a.ibT]]}),e})()}}]);